<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<META HTTP-EQUIV="Content-Language" CONTENT="ru">

<title>Лекция</title>
<style type="text/css">
 body {font-family: Arial, sans-serif;}
 .c {font-family: "Courier New", Courier, monospace}
</style>

</HEAD><BODY>

<div align="justify">

<p>&nbsp;</p>
<div align="center">
<p><strong>ДЕТЕРМИНИРОВАННЫЕ МЕТОДЫ ДОСТУПА К МОНОКАНАЛУ</strong></p>
</div>
<p>&nbsp;</p>

<p>При разработке любого из методов доступа к моноканалу один из базовых посылов -- это учет топологических особенностей сегмента. Если случайные методы уместно использовать при шинной топологии, применительно к которой четко выражена возможность возникновения коллизий, то детерминированные методы хорошо «ложатся» на кольцевую топологию.</p>

<p>Концептуальная разница между случайными и детерминированными методами заключается в том, возникает ли случайность при «обращении» станции к моноканалу.</p>

<p>Кольцо можно рассматривать как своеобразный моноканал, один такт работы которого представляет собой полный либо частичный «обход» кадром всех станций. Более подробно типичную кольцевую топологию можно представить следующим образом.</p>

<div align="center">
<img src="lk07.01.jpg">
<br>
Рисунок -- Цепи передатчика и приемника типичной кольцевой топологии
</div>

<p>Применительно к приведенной топологии, при доступе к моноканалу никаких проблем казалось бы возникать не должно. Действительно, физические коллизии для такой схемы невозможны, но проявляется то, что можно назвать особым видом логических коллизий. Если при некотором такте кольца какая-либо из станций имеет собственный кадр для передачи и при этом получила из кольца еще один кадр, который необходимо «продвигать» дальше, то появляется вопрос о том, какой из этих кадров передавать.</p>

<p>Частично противоречие может быть разрешено буферизацией кадров. Но возлагать на обычную пользовательскую станцию функции полноценного сетевого моста канального уровня крайне нецелесообразно. Кроме того, буферизация позволяет только «удерживать», то есть не терять кадры. Сугубо алгоритмический вопрос о том, какой же из кадров (имеющийся кадр для трансляции либо принятый кадр для ретрансляции) передавать раньше все-таки остается без ответа.</p>

<p>Единственным способом преодоления логических коллизий является введение <em>приоритетов</em> (priorities). В то время как все случайные методы «завязаны» на генератор случайных задержек, все детерминированные методы «завязаны» на систему приоритетов в том или ином виде. Возникает задача распределенного либо централизованного назначения приоритетов, причем ни одна из станций кольца заранее ничего «не знает» о других станциях.</p>

<p>При использовании механизма приоритетов не обойтись без специальных служебных кадров, которые в русскоязычной литературе обычно называются маркерами (tokens).</p>

<p>Таким образом, основные критерии классификации детерминированных методов:<br>
--&nbsp;централизованное либо распределенное управление;<br>
--&nbsp;алгоритм назначения приоритетов;<br>
--&nbsp;топологические особенности.</p>

<p>На эффективность детерминированных методов наиболее существенное влияние оказывают те же факторы, что и в случае со случайными методами:<br>
--&nbsp;количество взаимодействующих станций;<br>
--&nbsp;частота синхронизации;<br>
--&nbsp;длина кадра.</p>

<p>Если оценивать реализации, которые уже имеются на рынке, то все же детерминированные алгоритмы в среднем демонстрируют бо'льшую производительность. Однако оборудование в среднем более дорогостоящее.</p>

<p>С точки зрения изучения детерминированных методов доступа к моноканалу наиболее наглядным примером является еще один классический алгоритм, описанный в стандарте Token Ring (IEEE 802.5).</p>

<p>В Token Ring применяется централизованное управление. Закономерным следствием является необходимость включения в кольцо по крайней мере одной управляющей станции, наделенной особыми полномочиями и призванной инициализировать кольцо и следить за его работоспособностью. В терминологии Token Ring такая управляющая станция обобщенно называется <em>станцией-монитором</em> (monitor station). Кроме единственной основной станции-монитора (active monitor) в состав кольца может входить некоторое количество резервных (standby monitors).</p>

<p>Не смотря на то, что теоретически кольцо предполагает некоторую возможность «распараллеливания» (то есть, одновременно по разным частям кольца могут циркулировать несколько кадров), очень обобщенно алгоритм Token Ring можно представить как «бесконечно» циркулирующий под управлением станции-монитора маркер, который анализируется всеми пользовательскими станциями и к которому при необходимости «цепляются» данные.</p>

<p>В отличие от сегмента Ethernet, где все станции равноправны и действуют по одному и тому же алгоритму, в сегменте Token Ring предусмотрены станции несколько видов. Наряду с выделяемыми на канальном уровне станциями-мониторами, на более высоких уровнях рекомендуется выделять следующие станции:<br>
1.&nbsp;System managers -- системные менеджеры (на них сосредоточены управляющие системой на основе Token Ring процессы).<br>
2.&nbsp;Servers -- различные серверы (configuration report servers, ring error monitors, ring parameter servers).<br>
3.&nbsp;Data stations -- информационные станции (обычные пользовательские станции).<br>
Функциональное наполнение перечисленных видов станций выходит за рамки стандарта.</p>

<p>Для того чтобы понять заложенный в стандарт алгоритм, необходимо рассмотреть форматы кадров Token Ring и назначение основных полей.</p>

<p>В стандарте предусмотрены четыре вида передаваемых последовательностей:<br>
1.&nbsp;Token -- собственно маркер.<br>
2.&nbsp;Frame -- кадр.<br>
3.&nbsp;Abort Sequence -- прерывающая последовательность.<br>
4.&nbsp;Fill -- заполняющая последовательность.<br>
Каждая из станций в любое время должна распознавать (и различать) маркеры, кадры и специальные последовательности.</p>

<div align="center">
<img src="lk07.02.bmp">
<br>
Рисунок -- Формат маркера Token Ring
</div>

<p>&nbsp;</p>

<div align="center">
<img src="lk07.03.bmp">
<br>
Рисунок -- Формат кадра Token Ring
</div>

<p>&nbsp;</p>

<div align="center">
<img src="lk07.04.bmp">
<br>
Рисунок -- Формат прерывающей последовательности Token Ring
</div>

<p>Поля:<br>
1.&nbsp;SD (Starting Delimiter) -- начальный разделитель.<br>
2.&nbsp;AC (Access Control) -- контроль доступа.<br>
3.&nbsp;FC (Frame Control) -- контроль кадра.<br>
4.&nbsp;DA (Destination Address) -- адрес назначения.<br>
5.&nbsp;SA (Source Address) -- адрес источника.<br>
6.&nbsp;RI (Routing Information) -- информация о маршрутизации (может отсутствовать).<br>
7.&nbsp;INFO (Information) -- данные (могут отсутствовать).<br>
8.&nbsp;FCS (Frame Check Sequence) -- контрольная сумма.<br>
9.&nbsp;ED (Ending Delimiter) -- конечный разделитель.<br>
10.&nbsp;FS (Frame Status) -- состояние кадра.<br>
11.&nbsp;IFG (InterFrame Gap) -- межкадровый интервал.</p>

<p>SD и ED фактически являются флагами начала и конца кадра.</p>

<p>Между IFG и SD передается заполняющая последовательность.</p>

<p>С точки зрения алгоритма контроля доступа наибольший интерес представляет одноименное поле, а также поле состояния кадра.</p>

<div align="center">
<img src="lk07.05.bmp">
<br>
Рисунок -- Формат поля контроля доступа
</div>

<p>Где:<br>
1.&nbsp;P (Priority bits) -- текущий уровень приоритета.<br>
2.&nbsp;T (Token bit) -- идентификатор маркера: 0 -- маркер, 1 -- кадр.<br>
3.&nbsp;M (Monitor bit) -- бит монитора.<br>
4.&nbsp;R (Reservation bits) -- зарезервированный уровень приоритета.</p>

<div align="center">
<img src="lk07.06.bmp">
<br>
Рисунок -- Формат поля состояния кадра
</div>

<p>Где:<br>
1.&nbsp;A (Address-recognized bit) -- флаг распознания адреса (дублируется).<br>
2.&nbsp;C (frame-Copied bit) -- флаг копирования кадра (дублируется).<br>
3.&nbsp;r (reserved) -- зарезервировано.</p>

<p>Функции станции-монитора:<br>
1.&nbsp;Инициализировать подключившиеся к кольцу станции.<br>
2.&nbsp;Тактировать работу кольца.<br>
3.&nbsp;Контролировать наличие и валидность маркера.<br>
4.&nbsp;Предотвращать зацикливания.</p>

<p>В стандарте заложена комплексная система приоритетов, однако некоторые «тонкости» оставлены на откуп реализациям. Условно можно выделить два режима взаимодействия:<br>
1.&nbsp;Все станции имеют одинаковые приоритеты (отсутствие приоритетов).<br>
2.&nbsp;Станции могут иметь разные приоритеты (некоторые станции могут пользоваться кольцом более интенсивно).</p>

<p>Механизм приоритетов Token Ring основывается на связке из двух полей -- P и R. Поле P отображает текущий уровень приоритета, а поле R -- запрашиваемый. Каждое из этих полей может иметь значение от 000b до 111b, то есть доступно восемь уровней приоритета.
При отсутствии приоритетов станция-монитор создает и «запускает» в кольцо маркер с нулевыми полями P и R.</p>

<p>С помощью маркера, который передается по цепочке от станции к станции, предоставляется право на передачу. Если у станции нет своего кадра для передачи, то она передает маркер дальше. Если у станции есть кадр для передачи, то она захватывает маркер, заменой значения поля T с нуля на единицу преобразует маркер в кадр, добавляет все соответствующие поля и передает.</p>

<p>Внесенный таким образом в кольцо кадр ретранслируется всеми промежуточными станциями до тех пор, пока не достигнет адресованной станции-абонента. За удаление кадра из кольца ответственна станция, создавшая его. Поэтому станция-абонент, распознавшая свой адрес в принятом кадре, вместо удаления кадра отмечает факт распознавания присваиванием единичных значений обоим битам A и передает кадр дальше. Если станция-абонент «забирает» данные из кадра, то она присваивает единичные значения и обоим битам C. Значения битов A и C проверяются при возвращении кадра к создавшей его станции. На основании результатов проверки могут быть сделаны соответствующие выводы.</p>

<p>Но нужно освободить маркер. В нормальном случае станция возвращает маркер в кольцо сразу после того, как дождется возвращения кадра. Но существует возможность ускоренного освобождения маркера (early token release) -- маркер передается вслед за кадром.</p>

<p>При наличии приоритетов взаимодействие значительно усложняется. В такой ситуации необходимо различать следующие приоритеты (применительно к каждой станции):<br>
1.&nbsp;Уровень приоритета ожидающего передачи кадра <em>P<sub>f</sub></em>, причем в общем случае станция может генерировать кадры с разными уровнями приоритета.<br>
2.&nbsp;Значение поля P в принятом маркере либо кадре <em>P<sub>r</sub></em>.<br>
3.&nbsp;Значение поля R в принятом маркере либо кадре <em>R<sub>r</sub></em>.<br>
4.&nbsp;Значение поля P, которое будет записано в передаваемый маркер либо кадр <em>P<sub>t</sub></em>.<br>
5.&nbsp;Значение поля R, которое будет записано в передаваемый маркер либо кадр <em>R<sub>t</sub></em>.<p>


<p>В соответствии со стандартом можно разработать несколько моделей распределения приоритетов и поведения станций, но нужно учитывать следующие правила:<br>
1.&nbsp;Уровень приоритета кадра не может равняться нулю: <em>P<sub>f</sub></em>&nbsp;&ne;&nbsp;0.<br>
2.&nbsp;Для того чтобы станция смогла захватить маркер, должно выполняться условие: <em>P<sub>f</sub></em>&nbsp;&ge;&nbsp;<em>P<sub>r</sub></em>.<br>
3.&nbsp;Если невозможно захватить маркер, то есть при <em>P<sub>f</sub></em>&nbsp;&lt;&nbsp;<em>P<sub>r</sub></em>, и если <em>P<sub>f</sub></em>&nbsp;&ge;&nbsp;<em>R<sub>r</sub></em>, то станция может зарезервировать «следующий» маркер: <em>R<sub>t</sub></em>&nbsp;&larr;&nbsp;<em>P<sub>f</sub></em>.<br>
4.&nbsp;Станция может заранее зарезервировать «следующий» маркер в «проходящем» кадре если <em>P<sub>f</sub></em>&nbsp;&gt;&nbsp;<em>R<sub>r</sub></em>: <em>R<sub>t</sub></em>&nbsp;&larr;&nbsp;<em>P<sub>f</sub></em>.<br>
5.&nbsp;При невозможности захватить и зарезервировать маркер, маркер либо кадр ретранслируются без изменений.<br>
6.&nbsp;При захвате маркера выполняются следующие операции: <em>P<sub>t</sub></em>&nbsp;&larr;&nbsp;<em>P<sub>r</sub></em> и <em>R<sub>t</sub></em>&nbsp;&larr;&nbsp;0.<br>
7.&nbsp;При наличии захваченного маркера передаются все соответствующие ожидающие кадры.<br>
8.&nbsp;При освобождении маркера текущий уровень приоритета задается на основании зарезервированного: <em>P<sub>t</sub></em>&nbsp;&larr;&nbsp;<em>R<sub>r</sub></em>.<br>
9.&nbsp;При освобождении маркера станции предоставляется возможность временно повысить текущий уровень приоритета для ускорения передачи своих кадров: <em>P<sub>t</sub></em>&nbsp;&larr;&nbsp;<em>P<sub>f</sub></em>.<br>
10.&nbsp;Временно повысившая текущий уровень приоритета станция ответственна за его последующее восстановление (это достигается за счет использования стека).<br>
11.&nbsp;Станция-монитор не только создает и инициализирует маркер, а и может принимать участие в манипулировании с приоритетами.<br>
Соблюдение перечисленных правил гарантирует, что любая станция с любым приоритетом рано или поздно дождется возможности передать кадр.<p>

<p>Посредством кадров кроме сугубо пользовательской информации может передаваться и управляющая, относящаяся к канальному уровню. Отличительной особенностью Token Ring является то, что на канальном уровне регламентируется очень многое. При этом в поле данных включаются так называемый вектор (vector) и некоторое количество подвекторов (subvectors). Предусмотрено множество обязательных примитивов.

<p>Временны'е интервалы контролируются больши'м количеством обязательных таймеров.<p>

<p>Кроме всего прочего, в Token Ring заложено несколько механизмов обеспечения надежности, включая автореконфигурирование (autoreconfiguration) и сигнализацию об ошибках (beaconing).<p>

<p>Для предотвращения зацикливания станция-монитор метит все проходящие через нее маркеры со значением приоритета больше нуля и кадры, устанавливая значение бита M в единицу. Остальные станции этот бит не модифицируют. При исправном состоянии кольца уже помеченный кадр не должен еще раз «дойти» до станции-монитора. Если же это происходит, то станция-монитор инициирует «починку» кольца.<p>

<p>Во время передачи кадра при обнаружении ошибки станция прекращает передавать текущий кадр и передает прерывающую последовательность, тем самым сообщая принимающей станции о сбойном кадре.<p>

<p>Имеются возможности (в том числе аппаратные) гибкого подключения (inserting) и отключения (bypassing) станций от кольца.<p>

<p>В качестве контрольного кода используется код CRC.<p>

<p>Скорость Token Ring равняется 4 либо 16&nbsp;Mbit/s.<p>

<p>Кроме Token Ring следует упомянуть еще ряд существующих технологий -- реализаций детерминированных методов.<p>

<p>Технология ARCNET (Attached Resource Computer NETwork) была первой технологией ЛКС, нашедшей массовое применение до экспансии Ethernet, в том числе благодаря своей дешевизне. Cтандарт ATA 878.1 был разработан и утвержден ARCNET Trade Association. В настоящее время является сильно устаревшей. Скорость: 2,5&nbsp;Mbit/s. Логическая топология: однонаправленное кольцо. Физическая топология: шина или звезда. Во втором случае требовалось дополнительное сетевое оборудование (пассивные или активные концентраторы). Алгоритм являлся аналогом упрощенного варианта алгоритма Token Ring (без системы приоритетов).<p>

<p>Технология Token Bus разрабатывалась параллельно с Token Ring. Была стандартизирована как IEEE 802.4. Благодаря плохому масштабированию и сложности восстановления после сбоев, почти не применялась, только в промышленные сетях некоторых индустриальных компаний. Разработка давно остановлена, является сильно устаревшей. Скорость: 1, 5, 10 или 20&nbsp;Mbit/s. Логическая топология: однонаправленное кольцо. Физическая топология: шина. Алгоритм представлял собой адаптацию алгоритма Token Ring к шинной топологии.<p>

<p>Технология FDDI (Fiber Distributed Data Interface) разрабатывалась целенаправленно для поддержки оптических СрПД и позволяет значительно увеличить дальность передачи. Кроме собственно FDDI, еще был разработан аналогичный вариант для электрических СрПД под названием CDDI (Copper Distributed Data Interface (FDDI). FDDI формализован в виде комплекса стандартов, которые разрабатывались постепенно -- в основном ANSI и ISO. Ключевыми являются стандарты: ISO 9314-1, ISO 9314-2 и ISO 9314-3. FDDI стал быстро вытесняться с рынка сетевых технологий после появления более дешевого Fast Ethernet, но ограниченно применяется до сих пор. CDDI распространения так и не получил. Скорость: 100&nbsp;Mbit/s, 200&nbsp;Mbit/s. Логическая топология: однонаправленное кольцо с резервированием, то есть два отдельных кольца (если оба кольца исправны, то они функционируют параллельно). Физическая топология: двойное кольцо, к которому с помощью дополнительного сетевого оборудования могут подключаться деревья (узлами дерева являются концентраторы, листьями -- станции, концентратор-корень включается в двойное кольцо). Алгоритм представляет собой расширение алгоритма Token Bus.<p>

<p>Технология 100VG-AnyLAN была разработана HP и стала альтернативой Fast Ethernet. Идея заключалась в получении по тем временам высокоскоростного гибрида между Ethernet и Token Ring, причем с сохранением совместимости с их кадрами. Позже была стандартизована как IEEE 802.12. На технологию возлагались больши'е надежды, но она была быстро отвергнута рынком и в скорости практически исчезла. Скорость: 100&nbsp;Mbit/s. Логическая топология: дерево. Физическая топология: дерево (с опциональным резервированием), формируемое с помощью дополнительного сетевого оборудования (узлами дерева являются повторители, листьями -- станции или мосты, с помощью мостов можно подключать сегменты Ethernet или Token Ring). Метод доступа получил название Demand-priority. Основывается на программном автомате под названием MAC state machine.<p>

<p>Таким образом, существуют три основных способа выбора активного передатчика:<br>
1.&nbsp;Перепасовка маркера (token passing).<br>
2.&nbsp;Резервирование (reservation).<br>
3.&nbsp;Опрос (polling).<br>
Выбор может происходить и по расписанию.<p>

<p>Если в топологиях с множественным доступом канал не является моноканалом, то совместно использоваться он может следующими методами (channelization):<br>
1.&nbsp;FDMA (Frequency Division Multiple Access) -- множественный доступ на разных частотах (частотное разделение).<br>
2.&nbsp;TDMA (Time Division Multiple Access) -- множественный доступ на одной частоте в разные временны'е окна (временно'е разделение).<br>
3.&nbsp;CDMA (Code Division Multiple Access) -- множественный доступ на одной частоте с изменением параметров кодирования.<p>

</div>

</BODY>
</HTML>
